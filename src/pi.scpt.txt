on alfred_script(q)
  tell application "Path Finder"
    set pathList to POSIX path of the target of the front finder window
    set pathList to quoted form of pathList
  end tell
  
  tell application "System Events"
    set isRunning to (exists (processes where name is "iTerm"))
  end tell
  
  tell application "iTerm"
    activate
    if isRunning and (count of terminals) is 0 then
      make new terminal
    end if
    
    tell the first terminal
      if isRunning then
        launch session "Default Session"
      end if
      tell the last session to write text "clear; cd " & pathList
    end tell
  end tell
end alfred_script
